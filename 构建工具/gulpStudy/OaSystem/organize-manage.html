<!DOCTYPE html>
<html>
<head lang="en">
    <meta charset="UTF-8">
    <title>组织机构管理</title>
    <link rel="stylesheet" href="css/base.css"/>
    <link rel="stylesheet" href="css/organ.css"/>
</head>
<body>
    <div id="base">
        <div class="base-left" id="depart">
            <div class="second-level-menu">
                <a href="#" class="sort-tilte firm-title" data-menu="menu-sub">浙江核新同花顺有限公司
                    <i class="down-icon"></i>
                </a>
                <ul class="menu-sub menu-sub-show">
                    <li>
                        <div class="second-level-menu">
                            <a href="javascript:alert('111');" class="sort-tilte">总经理办公室
                            </a>
                        </div>
                    </li>
                    <li>
                        <div class="second-level-menu">
                            <a href="#" class="sort-tilte">人力资源部
                            </a>
                        </div>
                    </li>
                    <li>
                        <div class="second-level-menu">
                            <a href="#" class="sort-tilte">财务部
                            </a>
                        </div>
                    </li>
                    <li>
                        <div class="research">
                            <div class="second-level-menu">
                                <a href="#" class="sort-tilte" data-menu="menu-sub">研发部
                                    <i class="down-icon"></i>
                                </a>
                                <ul class="menu-sub menu-sub-show">
                                    <li>
                                        <div class="second-level-menu">
                                            <a href="#" class="sort-tilte iFind-title" data-menu="menu-sub">iFinD事业部
                                                <i class="down-icon"></i>
                                            </a>
                                            <ul class="menu-sub menu-sub-show">
                                                <li>
                                                    <div class="second-level-menu">
                                                        <a href="#" class="sort-tilte iFind-project" data-menu="menu-sub">OA项目组
                                                            <i class="down-icon"></i>
                                                        </a>
                                                        <ul class="menu-sub menu-sub-show">
                                                            <li><a href="#">开发组</a></li>
                                                        </ul>
                                                    </div>
                                                </li>
                                                <li>
                                                    <div class="second-level-menu">
                                                        <a href="#" class="sort-tilte iFind-project" data-menu="menu-sub">小贷项目组
                                                            <i class="down-icon"></i>
                                                        </a>
                                                        <ul class="menu-sub menu-sub-show">
                                                            <li><a href="#">开发组</a></li>
                                                            <li><a href="#">测试组</a></li>
                                                            <li><a href="#">服务端</a></li>
                                                            <li><a href="#">客户端</a></li>
                                                        </ul>
                                                    </div>
                                                </li>
                                            </ul>
                                        </div>
                                    </li>
                                </ul>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>
        </div>
        <div class="base-right">
            <!--  todo 用户信息-->
            <div class="info">
                <div class="operate">
                    <button class="btn btn-active" data-target="add-Modal" id="add" >新增</button>
                    <button class="btn btn-primary"  id="update">修改</button>
                    <button class="btn btn-disabled">解散</button>
                    <!--  todo 排序-->
                    <button class="btn btn-primary" data-target="sort-Modal" id="sort" >排序</button>
                </div>
                <!--  todo 排序表格-->
                <table class="table specific-info">
                    <thead>
                    <tr>
                        <th>
                            <input type="checkbox" class="check-icon" id="check-all"/>全选
                            <i class="line-icon"></i>
                        </th>
                        <th>序号 <i class="line-icon"></i></th>
                        <th>名称 <i class="line-icon"></i></th>
                        <th>描述 <i class="line-icon"></i></th>
                        <th>级别 <i class="line-icon"></i></th>
                        <th>排序 <i class="line-icon"></i></th>
                        <th>创建人</th>
                    </tr>
                    </thead>
                    <tbody id="user-list">
                    <tr>
                        <td>
                            <input type="checkbox" class="check-icon"/>
                        </td>
                        <td>1</td>
                        <td>浙江核心同花顺有限公司</td>
                        <td></td>
                        <td>0</td>
                        <td>1</td>
                        <td>管理员</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" class="check-icon"/>
                        </td>
                        <td>2</td>
                        <td>研发部</td>
                        <td></td>
                        <td>1</td>
                        <td>4</td>
                        <td>管理员</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" class="check-icon"/>
                        </td>
                        <td>3</td>
                        <td>研发部-iFinD事业部</td>
                        <td></td>
                        <td>2</td>
                        <td>1</td>
                        <td>张三</td>
                    </tr>
                    <tr>
                        <td>
                            <input type="checkbox" class="check-icon"/>
                        </td>
                        <td>4</td>
                        <td>研发部-iFinD事业部-OA项目组</td>
                        <td></td>
                        <td>3</td>
                        <td>1</td>
                        <td>李四</td>
                    </tr>
                    </tbody>
                </table>
                <!--  todo 表单信息列表-->
                <div class="form-default organ-form">
                    <div class="form-group">
                        <label class="form-info">组织机构全称：</label>
                        <input type="text" class="form-primary"/>
                    </div>
                    <div class="form-group">
                        <label class="form-info">组织机构单位：</label>
                        <input type="text" class="form-primary"/>
                    </div>
                    <div class="form-group">
                        <label class="form-info">描述：</label>
                        <textarea class="form-textarea" id="form-textarea"></textarea>
                    </div>
                    <div class="form-group">
                        <label class="form-info">创建人：</label>
                        <input type="text" class="form-primary"/>
                    </div>
                    <div class="form-group">
                        <label class="form-info">创建时间：</label>
                        <input type="text" class="form-primary"/>
                    </div>
                    <div class="form-group">
                        <label class="form-info">最近修改人：</label>
                        <input type="text" class="form-primary"/>
                    </div>
                    <div class="form-group">
                        <label class="form-info">最近修改时间：</label>
                        <input type="text" class="form-primary"/>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <!--   todo 增加弹出框-->
    <div class="modal" id="add-Modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-title">
                    <h3>新增组织机构</h3>
                    <span class="close-icon close">&times;</span>
                </div>
                <div class="modal-body">
                    <!--  todo 表单-->
                    <form class="form-default">
                        <div class="form-group">
                            <label class="form-info">组织机构名称</label>
                            <input type="text" class="form-primary" id="organTitle"/>
                           <!--
                            <div class="err-popup">
                                <h3 class="errMsg">组织机构名称不能为空</h3>
                            </div>  -->
                        </div>
                        <div class="form-group">
                            <label class="form-info">父组织机构名称</label>
                            <input type="text" class="form-primary"  id="p-organTitle" placeholder="OA" name="organTitle"/>
                        </div>
                        <div class="form-group">
                            <label class="form-info">排序号</label>
                            <input type="text" class="form-primary " id="order" name="order"/>
                        </div>
                        <div class="form-group">
                            <label class="form-info">描述：</label>
                            <textarea class="form-textarea" id="organ-text" name="organText"></textarea>
                        </div>
                        <div class="form-group">
                            <div class="form-submit">
                                <input type="button"  id="add-submit" class="btn btn-active" value="确定"/>
                                <button class="btn btn-primary close">取消</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <div class="modal" id="update-Modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-title">
                    <h3>修改组织机构</h3>
                    <span class="close-icon close">&times;</span>
                </div>
                <div class="modal-body">
                    <form class="form-default">
                        <div class="form-group">
                            <label class="form-info">组织机构名称</label>
                            <input type="text" class="form-primary" id="up-organTitle" />
                        </div>
                        <div class="form-group">
                            <label class="form-info">父组织机构名称</label>
                            <input type="text" class="form-primary" placeholder="OA项目组"/>
                        </div>
                        <div class="form-group">
                            <label class="form-info">排序号</label>
                            <input type="text" class="form-primary" id="up-order"/>
                        </div>
                        <div class="form-group">
                            <label class="form-info">描述：</label>
                            <textarea class="form-textarea" id="up-text"></textarea>
                        </div>
                        <div class="form-group">
                            <div class="form-submit">
                                <input type="button"  id="update-submit" class="btn btn-active" value="确定"/>
                                <button class="btn btn-primary close">取消</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    <!--  排序弹出框-->
    <div class="modal" id="sort-Modal">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-title">
                    <h3>组织机构排序</h3>
                    <span class="close-icon close">&times;</span>
                </div>
                <div class="modal-body">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>序号<i class="line-icon"></i></th>
                            <th>名称<i class="line-icon"></i></th>
                            <th>序号</th>
                        </tr>
                        </thead>
                        <tbody>
                        <tr>
                            <td>1</td>
                            <td>OA项目组</td>
                            <td>1</td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>小贷项目组</td>
                            <td>2</td>
                        </tr>
                        </tbody>
                    </table>

                </div>
                <div class="modal-footer">
                    <button class="btn btn-primary close">保存</button>
                    <button class="btn btn-primary close">取消</button>
                </div>
            </div>
        </div>
    </div>
    <script src="js/jquery-1.11.3.js"></script>
    <script src="js/base.js"></script>
    <script>
        // todo 表单验证
        $('#add-submit').click(function(e){
            if(!$('#organTitle').val()){
                errPop("组织机构名称不能为空！",'#organTitle');
            }else if(!$('#p-organTitle').val()){
                errPop("父组织机构名称不能为空！",'#p-organTitle');
            }else {
                $(this).parents('.modal').eq(0).removeClass('show');
                // todo 获取弹出框的内容
                var json_organText=[
                    { "order":$('#order').val(), "organTitle":$('#organTitle').val(),
                        "organText":$('#organ-text').val(), "level":parseInt(Math.random()*5),
                        "sort":parseInt(Math.random()*5),"creater":"管理员"
                    }];
                $('#user-list').append(`
            <tr>
                <td>
                      <input type="checkbox" class="check-icon"/>
                 </td>
                 <td>${json_organText[0].order}</td>
                 <td>${json_organText[0].organTitle}</td>
                 <td>${json_organText[0].organText}</td>
                 <td>${json_organText[0].level}</td>
                 <td>${json_organText[0].sort}</td>
                 <td>${json_organText[0].creater}</td>
            </tr>  `
                );
            }
        });
        /* todo 全选操作 */
        $('#check-all').click(function () {
            allSel(this,'#user-list :checkbox');
        })
        // todo 子复选框判断全选事件
        $("#user-list").on('click',':checkbox',function(){
            allchk('#user-list :checkbox','#check-all');
        });
        // todo 修改操作
        $('#update').click(function(){
            var chknum = $("#user-list :checkbox").size();
            var unchk=0;
            $("#user-list :checkbox").each(function () {
                if($(this).prop("checked")==false){
                    unchk++;
                }
            });
            if(chknum==unchk){
                alert("请选择您要修改的选项！");
                return  false;
            }
            $('#update-Modal').addClass('show');
        })

        // todo 清除弹出框
        $('#update-Modal .close').click(function(){
            $('#update-Modal').removeClass('show');
        })
        $('#update-submit').click(function () {
            var target=$('#user-list').find('.check-icon:checked').parent().parent();  //tr
            $(target).children().eq(2).html($('#up-organTitle').val());
            $(target).children().eq(3).html($('#up-text').val());
            $(target).children().eq(5).html($('#up-order').val());
            $('#update-Modal').removeClass('show');

        })
    </script>
</body>
</html>